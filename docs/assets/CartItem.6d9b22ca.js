import{d as e,f as t,n as a,aV as l,a8 as o,l as n,ag as s,a6 as i,aY as r,aX as u,b7 as c,b8 as d,o as m,c as p,w as f,L as g,e as v,b5 as h,a7 as w,t as b,a as x}from"./vendor.e60456f3.js";import{I as B}from"./index.aa76e96d.js";import{C as y}from"./index.7e4216b6.js";import{u as C}from"./index.aa52fcaa.js";import{P as k,p as S,a as T,m as P,u as V,T as O}from"./function-call.7be5e6a9.js";import{B as I}from"./index.e74be4f5.js";import{q as M,c as j,t as W,w as z,u as H,h as N,e as F,r as L,G as q,j as A,n as U,a as D,m as E,T as X,U as R,d as _,O as G,P as Y,v as $,p as J,H as K,l as Q,k as Z,i as ee,V as te,o as ae,W as le,X as oe,B as ne}from"./index.84f5d824.js";import{u as se,a as ie}from"./on-popup-reopen.d93741ed.js";import{c as re}from"./interceptor.f210eca8.js";var ue,[ce,de]=j("action-bar"),me=Symbol(ce),pe=z(e({name:ce,props:{safeAreaInsetBottom:W},setup(e,a){var{slots:l}=a,{linkChildren:o}=M(me);return o(),()=>t("div",{class:[de(),{"van-safe-area-bottom":e.safeAreaInsetBottom}]},[null==l.default?void 0:l.default()])}})),[fe,ge]=j("action-bar-button"),ve=z(e({name:fe,props:F({},L,{type:String,text:String,icon:String,color:String,loading:Boolean,disabled:Boolean}),setup(e,l){var{slots:o}=l,n=H(),{parent:s,index:i}=N(me),r=a((()=>{if(s){var e=s.children[i.value-1];return!(e&&"isButton"in e)}})),u=a((()=>{if(s){var e=s.children[i.value+1];return!(e&&"isButton"in e)}}));return se({isButton:!0}),()=>{var{type:a,icon:l,text:s,color:i,loading:c,disabled:d}=e;return t(I,{class:ge([a,{last:u.value,first:r.value}]),size:"large",type:a,icon:l,color:i,loading:c,disabled:d,onClick:n},{default:()=>[o.default?o.default():s]})}}})),[he,we,be]=j("dialog"),xe=F({},S,{title:String,theme:String,width:U,message:[String,Function],callback:Function,allowHtml:Boolean,className:D,transition:E("van-dialog-bounce"),messageAlign:String,closeOnPopstate:W,showCancelButton:Boolean,cancelButtonText:String,cancelButtonColor:String,confirmButtonText:String,confirmButtonColor:String,showConfirmButton:W,closeOnClickOverlay:Boolean}),Be=[...T,"transition","closeOnPopstate"],ye=e({name:he,props:xe,emits:["confirm","cancel","update:show"],setup(e,a){var{emit:n,slots:s}=a,i=l({confirm:!1,cancel:!1}),r=e=>n("update:show",e),u=t=>{r(!1),null==e.callback||e.callback(t)},c=t=>()=>{e.show&&(n(t),e.beforeClose?(i[t]=!0,re(e.beforeClose,{args:[t],done(){u(t),i[t]=!1},canceled(){i[t]=!1}})):u(t))},d=c("cancel"),m=c("confirm"),p=()=>{var a=s.title?s.title():e.title;if(a)return t("div",{class:we("header",{isolated:!e.message&&!s.default})},[a])},f=a=>{var{message:l,allowHtml:o,messageAlign:n}=e,s=we("message",{"has-title":a,[n]:n}),i=_(l)?l():l;return o&&"string"==typeof i?t("div",{class:s,innerHTML:i},null):t("div",{class:s},[i])},g=()=>{if(s.default)return t("div",{class:we("content")},[s.default()]);var{title:a,message:l,allowHtml:o}=e;if(l){var n=!(!a&&!s.title);return t("div",{key:o?1:0,class:we("content",{isolated:!n})},[f(n)])}},v=()=>s.footer?s.footer():"round-button"===e.theme?t(pe,{class:we("footer")},{default:()=>[e.showCancelButton&&t(ve,{type:"warning",text:e.cancelButtonText||be("cancel"),class:we("cancel"),color:e.cancelButtonColor,loading:i.cancel,onClick:d},null),e.showConfirmButton&&t(ve,{type:"danger",text:e.confirmButtonText||be("confirm"),class:we("confirm"),color:e.confirmButtonColor,loading:i.confirm,onClick:m},null)]}):t("div",{class:[R,we("footer")]},[e.showCancelButton&&t(I,{size:"large",text:e.cancelButtonText||be("cancel"),class:we("cancel"),style:{color:e.cancelButtonColor},loading:i.cancel,onClick:d},null),e.showConfirmButton&&t(I,{size:"large",text:e.confirmButtonText||be("confirm"),class:[we("confirm"),{[X]:e.showCancelButton}],style:{color:e.confirmButtonColor},loading:i.confirm,onClick:m},null)]);return()=>{var{width:a,title:l,theme:n,message:s,className:i}=e;return t(k,o({role:"dialog",class:[we([n]),i],style:{width:A(a)},"aria-labelledby":l||s,"onUpdate:show":r},q(e,Be)),{default:()=>[p(),g(),v()]})}}});function Ce(e){return G?new Promise(((a,l)=>{var n;ue||(n={setup(){var{state:e,toggle:a}=V();return()=>t(ye,o(e,{"onUpdate:show":a}),null)}},({instance:ue}=P(n))),ue.open(F({},Ce.currentOptions,e,{callback:e=>{("confirm"===e?a:l)(e)}}))})):Promise.resolve()}Ce.defaultOptions={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,confirmButtonText:"",confirmButtonColor:null,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1},Ce.currentOptions=F({},Ce.defaultOptions),Ce.alert=Ce,Ce.confirm=e=>Ce(F({showCancelButton:!0},e)),Ce.close=()=>{ue&&ue.toggle(!1)},Ce.setDefaultOptions=e=>{F(Ce.currentOptions,e)},Ce.resetDefaultOptions=()=>{Ce.currentOptions=F({},Ce.defaultOptions)},Ce.Component=z(ye),Ce.install=e=>{e.use(Ce.Component),e.config.globalProperties.$dialog=Ce};var[ke,Se]=j("stepper"),Te=(e,t)=>String(e)===String(t),Pe=z(e({name:ke,props:{min:Q(1),max:Q(1/0),name:Q(""),step:Q(1),theme:String,integer:Boolean,disabled:Boolean,showPlus:W,showMinus:W,showInput:W,longPress:W,allowEmpty:Boolean,modelValue:U,inputWidth:U,buttonSize:U,placeholder:String,disablePlus:Boolean,disableMinus:Boolean,disableInput:Boolean,beforeChange:Function,defaultValue:Q(1),decimalLength:U},emits:["plus","blur","minus","focus","change","overlimit","update:modelValue"],setup(e,l){var c,d,m,p,f,g,{emit:v}=l,h=t=>{var{min:a,max:l,allowEmpty:o,decimalLength:n}=e;return o&&""===t||(t=""===(t=Z(String(t),!e.integer))?0:+t,t=Number.isNaN(t)?+a:t,t=Math.max(Math.min(+l,t),+a),ee(n)&&(t=t.toFixed(+n))),t},w=n(),b=n((m=null!=(d=e.modelValue)?d:e.defaultValue,p=h(m),Te(p,e.modelValue)||v("update:modelValue",p),p)),x=a((()=>e.disabled||e.disableMinus||b.value<=+e.min)),B=a((()=>e.disabled||e.disablePlus||b.value>=+e.max)),y=a((()=>({width:A(e.inputWidth),height:A(e.buttonSize)}))),C=a((()=>Y(e.buttonSize))),k=t=>{e.beforeChange?re(e.beforeChange,{args:[t],done(){b.value=t}}):b.value=t},S=()=>{if("plus"===c&&B.value||"minus"===c&&x.value)v("overlimit",c);else{var t="minus"===c?-e.step:+e.step,a=h(te(+b.value,t));k(a),v(c)}},T=t=>{var a=t.target,{value:l}=a,{decimalLength:o}=e,n=Z(String(l),!e.integer);if(ee(o)&&n.includes(".")){var s=n.split(".");n=s[0]+"."+s[1].slice(0,+o)}e.beforeChange?a.value=String(b.value):Te(l,n)||(a.value=n);var i=n===String(+n);k(i?+n:n)},P=t=>{var a;e.disableInput?null==(a=w.value)||a.blur():v("focus",t)},V=e=>{var t=e.target,a=h(t.value);t.value=String(a),b.value=a,u((()=>{v("blur",e),ae()}))},O=()=>{g=setTimeout((()=>{S(),O()}),200)},I=t=>{e.longPress&&(clearTimeout(g),f&&J(t))},M=t=>{e.disableInput&&J(t)},j=t=>({onClick:e=>{J(e),c=t,S()},onTouchstart:()=>{c=t,e.longPress&&(f=!1,clearTimeout(g),g=setTimeout((()=>{f=!0,S(),O()}),600))},onTouchend:I,onTouchcancel:I});return s((()=>[e.max,e.min,e.integer,e.decimalLength]),(()=>{var e=h(b.value);Te(e,b.value)||(b.value=e)})),s((()=>e.modelValue),(e=>{Te(e,b.value)||(b.value=h(e))})),s(b,(t=>{v("update:modelValue",t),v("change",t,{name:e.name})})),$((()=>e.modelValue)),()=>t("div",{role:"group",class:Se([e.theme])},[i(t("button",o({type:"button",style:C.value,class:[Se("minus",{disabled:x.value}),{[K]:!x.value}],"aria-disabled":x.value||void 0},j("minus")),null),[[r,e.showMinus]]),i(t("input",{ref:w,type:e.integer?"tel":"text",role:"spinbutton",class:Se("input"),value:b.value,style:y.value,disabled:e.disabled,readonly:e.disableInput,inputmode:e.integer?"numeric":"decimal",placeholder:e.placeholder,"aria-valuemax":e.max,"aria-valuemin":e.min,"aria-valuenow":b.value,onBlur:V,onInput:T,onFocus:P,onMousedown:M},null),[[r,e.showInput]]),i(t("button",o({type:"button",style:C.value,class:[Se("plus",{disabled:B.value}),{[K]:!B.value}],"aria-disabled":B.value||void 0},j("plus")),null),[[r,e.showPlus]])])}})),[Ve,Oe]=j("swipe-cell"),Ie=z(e({name:Ve,props:{name:Q(""),disabled:Boolean,leftWidth:U,rightWidth:U,beforeClose:Function,stopPropagation:Boolean},emits:["open","close","click"],setup(e,o){var s,i,r,{emit:u,slots:c}=o,d=n(),m=n(),p=n(),f=l({offset:0,dragging:!1}),g=ie(),v=e=>e.value?le(e).width:0,h=a((()=>ee(e.leftWidth)?+e.leftWidth:v(m))),w=a((()=>ee(e.rightWidth)?+e.rightWidth:v(p))),b=t=>{s=!0,f.offset="left"===t?h.value:-w.value,u("open",{name:e.name,position:t})},x=t=>{f.offset=0,s&&(s=!1,u("close",{name:e.name,position:t}))},B=t=>{e.disabled||(r=f.offset,g.start(t))},y=t=>{if(!e.disabled){var{deltaX:a}=g;if(g.move(t),g.isHorizontal())i=!0,f.dragging=!0,(!s||a.value*r<0)&&J(t,e.stopPropagation),f.offset=ne(a.value+r,-w.value,h.value)}},C=()=>{var e,t,a,l;f.dragging&&(f.dragging=!1,e=f.offset>0?"left":"right",t=Math.abs(f.offset),a=s?.85:.15,(l="left"===e?h.value:w.value)&&t>l*a?b(e):x(e),setTimeout((()=>{i=!1}),0))},k=function(t){void 0===t&&(t="outside"),u("click",t),s&&!i&&re(e.beforeClose,{args:[{name:e.name,position:t}],done:()=>x(t)})},S=(e,t)=>a=>{t&&a.stopPropagation(),k(e)},T=(e,a)=>{var l=c[e];if(l)return t("div",{ref:a,class:Oe(e),onClick:S(e,!0)},[l()])};return se({open:b,close:x}),oe(d,(()=>k("outside")),{eventName:"touchstart"}),()=>{var e={transform:"translate3d("+f.offset+"px, 0, 0)",transitionDuration:f.dragging?"0s":".6s"};return t("div",{ref:d,class:Oe(),onClick:S("cell"),onTouchstart:B,onTouchmove:y,onTouchend:C,onTouchcancel:C},[t("div",{class:Oe("wrapper"),style:e},[T("left",m),null==c.default?void 0:c.default(),T("right",p)])])}}}));const Me={class:"tw-p-2 tw-mt-3 tw-bg-white tw-rounded-md"},je={class:"tw-flex tw-items-center"},We={class:"tw-flex-grow tw-grid tw-grid-cols-7 tw-items-center tw-gap-3"},ze={class:"tw-col-span-5 tw-self-start"},He={class:"tw-line-clamp-3 tw-break-all tw-text-medium tw-leading-none"},Ne={class:"tw-inline tw-text-dark"},Fe={class:"tw-ml-2 tw-text-xs tw-text-light"},Le={class:"tw-mt-2 tw-flex tw-items-center"},qe={class:"tw-text-primary tw-font-bold"},Ae=v("span",{class:"tw-ml-1 tw-text-primary tw-text-xs"},"元/月",-1),Ue={key:0,class:"tw-ml-auto tw-text-sm tw-font-semibold"},De=e({props:{item:null,checked:{type:Boolean,default:!1},quantity:{default:0},readonly:{type:Boolean,default:!1}},emits:["update:checked","update:quantity"],setup(e,{emit:a}){const l=e,o=c(l,"checked",a),n=c(l,"quantity",a),i=C();s((()=>i.itemPatchingErrorMessage||i.itemRemovingErrorMessage),(e=>{e&&O(e)})),d(n,(()=>{i.patchItem(l.item)}),{debounce:500});const r=async()=>{try{await Ce.confirm({title:"提示",message:"是否确认删除？"});await i.removeItem(l.item)&&(i.items=i.items.filter((e=>e.id!==l.item.id)))}catch(e){}};return(a,l)=>{const s=y,u=B,c=Pe,d=I,C=Ie;return m(),p(C,{disabled:e.readonly},{right:f((()=>[t(d,{square:"",text:"删除",type:"danger",class:"!tw-h-full",loading:g(i).isItemRemoving,onClick:r},null,8,["loading"])])),default:f((()=>[v("div",Me,[v("div",je,[e.readonly?w("",!0):(m(),p(s,{key:0,modelValue:g(o),"onUpdate:modelValue":l[0]||(l[0]=e=>h(o)?o.value=e:null),class:"tw-flex-shrink-0 tw-pr-1.5","icon-size":"18px"},null,8,["modelValue"])),v("div",We,[t(u,{class:"tw-col-span-2 tw-w-full tw-aspect-w-1 tw-aspect-h-1",src:e.item.thumbnail,fit:"cover",round:"",radius:"8px"},null,8,["src"]),v("div",ze,[v("div",He,[v("figcaption",Ne,b(e.item.title),1),v("span",Fe,b(e.item.body),1)]),v("div",Le,[v("span",qe,b(e.item.price),1),Ae,e.readonly?(m(),x("span",Ue," x"+b(g(n)),1)):(m(),p(c,{key:1,modelValue:g(n),"onUpdate:modelValue":l[1]||(l[1]=e=>h(n)?n.value=e:null),class:"tw-ml-auto",integer:"",min:"1",max:"99",disabled:g(i).isItemPatching},null,8,["modelValue","disabled"]))])])])])])])),_:1},8,["disabled"])}}});export{Ce as D,De as _};
