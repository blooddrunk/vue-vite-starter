var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,r=(t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s;import{a$ as l,b0 as n,d,l as u,aV as c,n as m,ag as p,f,b4 as v,b9 as h,aa as w,aX as g,o as x,a as b,e as y,r as j,c as T,w as k,t as V,L as O,ba as I,bb as D,a9 as S,F as B,b as C,b5 as P,p as _,bc as H,i as L,a4 as A,bd as E}from"./vendor.e60456f3.js";import{I as z}from"./index.aa76e96d.js";import{S as U,u as M}from"./index.aa52fcaa.js";import{_ as R,a as Y}from"./index.a9a156c1.js";import{T as F,P as q}from"./function-call.7be5e6a9.js";import{L as G,B as J}from"./index.e74be4f5.js";import{E as N}from"./index.ad89b4c6.js";import{u as W}from"./product.65deb8b7.js";import{O as X,J as Z,Y as $,D as K,e as Q,L as ee,N as te,c as ae,n as se,m as ie,l as oe,Z as re,W as le,_ as ne,w as de,t as ue,p as ce}from"./index.84f5d824.js";import{u as me,a as pe}from"./on-popup-reopen.d93741ed.js";import{_ as fe}from"./GoToCartButton.8dc6353b.js";import{a as ve,A as he}from"./index.13efafc2.js";import"./index.9bc79dd0.js";import"./useAxios.d5dc9735.js";import"./math.c4a34419.js";import"./interceptor.f210eca8.js";import"./product.c7441195.js";import"./usePaginatedList.9bed8c28.js";var[we,ge]=ae("sticky"),xe=de(d({name:we,props:{zIndex:se,position:ie("top"),container:Object,offsetTop:oe(0),offsetBottom:oe(0)},emits:["scroll","change"],setup(e,t){var{emit:a,slots:s}=t,i=u(),o=$(i),r=c({fixed:!1,width:0,height:0,transform:0}),d=m((()=>K("top"===e.position?e.offsetTop:e.offsetBottom))),v=m((()=>{var{fixed:e,height:t,width:a}=r;if(e)return{width:a+"px",height:t+"px"}})),h=m((()=>{if(r.fixed){var t=Q(ee(e.zIndex),{width:r.width+"px",height:r.height+"px",[e.position]:d.value+"px"});return r.transform&&(t.transform="translate3d(0, "+r.transform+"px, 0)"),t}})),w=()=>{if(i.value&&!re(i)){var{container:t,position:s}=e,o=le(i),l=ne(window);if(r.width=o.width,r.height=o.height,"top"===s)if(t){var n=le(t),u=n.bottom-d.value-r.height;r.fixed=d.value>o.top&&n.bottom>0,r.transform=u<0?u:0}else r.fixed=d.value>o.top;else{var{clientHeight:c}=document.documentElement;if(t){var m=le(t),p=c-m.top-d.value-r.height;r.fixed=c-d.value<o.bottom&&c>m.top,r.transform=p<0?-p:0}else r.fixed=c-d.value<o.bottom}(e=>{a("scroll",{scrollTop:e,isFixed:r.fixed})})(l)}};return p((()=>r.fixed),(e=>a("change",e))),te("scroll",w,{target:o}),function(e,t){if(X&&window.IntersectionObserver){var a=new IntersectionObserver((e=>{t(e[0].intersectionRatio>0)}),{root:document.body}),s=()=>{e.value&&a.unobserve(e.value)};l(s),n(s),Z((()=>{e.value&&a.observe(e.value)}))}}(i,w),()=>f("div",{ref:i,style:v.value},[f("div",{class:ge({fixed:r.fixed}),style:h.value},[null==s.default?void 0:s.default()])])}})),be=Symbol(),[ye,je,Te]=ae("list"),ke=de(d({name:ye,props:{error:Boolean,offset:oe(300),loading:Boolean,finished:Boolean,errorText:String,direction:ie("down"),loadingText:String,finishedText:String,immediateCheck:ue},emits:["load","update:error","update:loading"],setup(e,t){var{emit:a,slots:s}=t,i=u(!1),o=u(),r=u(),l=v(be,null),n=$(o),d=()=>{g((()=>{if(!(i.value||e.finished||e.error||!1===(null==l?void 0:l.value))){var{offset:t,direction:s}=e,d=le(n);if(d.height&&!re(o)){var u=le(r);("up"===s?d.top-u.top<=t:u.bottom-d.bottom<=t)&&(i.value=!0,a("update:loading",!0),a("load"))}}}))},c=()=>{if(e.finished){var t=s.finished?s.finished():e.finishedText;if(t)return f("div",{class:je("finished-text")},[t])}},m=()=>{a("update:error",!1),d()},x=()=>{if(e.error){var t=s.error?s.error():e.errorText;if(t)return f("div",{role:"button",class:je("error-text"),tabindex:0,onClick:m},[t])}},b=()=>{if(i.value&&!e.finished)return f("div",{class:je("loading")},[s.loading?s.loading():f(G,{class:je("loading-icon")},{default:()=>[e.loadingText||Te("loading")]})])};return p((()=>[e.loading,e.finished,e.error]),d),l&&p(l,(e=>{e&&d()})),h((()=>{i.value=e.loading})),w((()=>{e.immediateCheck&&d()})),me({check:d}),te("scroll",d,{target:n}),()=>{var t=null==s.default?void 0:s.default(),a=f("div",{ref:r,class:je("placeholder")},null);return f("div",{ref:o,role:"feed",class:je(),"aria-busy":i.value},["down"===e.direction?t:a,b(),c(),x(),"up"===e.direction?t:a])}}})),[Ve,Oe,Ie]=ae("pull-refresh"),De=["pulling","loosing","success"],Se=de(d({name:Ve,props:{disabled:Boolean,modelValue:Boolean,headHeight:oe(50),successText:String,pullingText:String,loosingText:String,loadingText:String,pullDistance:se,successDuration:oe(500),animationDuration:oe(300)},emits:["refresh","update:modelValue"],setup(e,t){var a,{emit:s,slots:i}=t,o=u(),r=$(o),l=c({status:"normal",distance:0,duration:0}),n=pe(),d=()=>{if(50!==e.headHeight)return{height:e.headHeight+"px"}},m=()=>"loading"!==l.status&&"success"!==l.status&&!e.disabled,v=(t,a)=>{var s=+(e.pullDistance||e.headHeight);l.distance=t,l.status=a?"loading":0===t?"normal":t<s?"pulling":"loosing"},h=()=>{var{status:t}=l;return"normal"===t?"":e[t+"Text"]||Ie(t)},w=()=>{var{status:e,distance:t}=l;if(i[e])return i[e]({distance:t});var a=[];return De.includes(e)&&a.push(f("div",{class:Oe("text")},[h()])),"loading"===e&&a.push(f(G,{class:Oe("loading")},{default:h})),a},x=e=>{(a=0===ne(r.value))&&(l.duration=0,n.start(e))},b=e=>{m()&&x(e)},y=t=>{if(m()){a||x(t);var{deltaY:s}=n;n.move(t),a&&s.value>=0&&n.isVertical()&&(ce(t),v((i=s.value,o=+(e.pullDistance||e.headHeight),i>o&&(i=i<2*o?o+(i-o)/2:1.5*o+(i-2*o)/4),Math.round(i))))}var i,o},j=()=>{a&&n.deltaY.value&&m()&&(l.duration=+e.animationDuration,"loosing"===l.status?(v(+e.headHeight,!0),s("update:modelValue",!0),g((()=>s("refresh")))):v(0))};return p((()=>e.modelValue),(t=>{l.duration=+e.animationDuration,t?v(+e.headHeight,!0):i.success||e.successText?(l.status="success",setTimeout((()=>{v(0)}),+e.successDuration)):v(0,!1)})),()=>{var e={transitionDuration:l.duration+"ms",transform:l.distance?"translate3d(0,"+l.distance+"px, 0)":""};return f("div",{ref:o,class:Oe()},[f("div",{class:Oe("track"),style:e,onTouchstart:b,onTouchmove:y,onTouchend:j,onTouchcancel:j},[f("div",{class:Oe("head"),style:d()},[w()]),null==i.default?void 0:i.default()])])}}}));const Be={},Ce={class:"tw-p-2 tw-mt-3 tw-bg-white tw-rounded-md tw-shadow tw-shadow-light"},Pe=y("div",{class:"tw-bg-light tw-rounded tw-h-32"},null,-1);var _e=R(Be,[["render",function(e,t){const a=U;return x(),b("div",Ce,[Pe,f(a,{class:"tw-mt-3",title:"",row:3})])}]]);const He={class:"tw-p-2 tw-mt-3 tw-bg-white tw-rounded-md tw-shadow tw-shadow-light"},Le={class:"tw-line-clamp-3 tw-break-all tw-text-medium"},Ae={class:"tw-inline tw-text-dark"},Ee={class:"tw-ml-2 tw-text-xs tw-text-light"},ze={class:"tw-py-1 tw-flex tw-items-center"},Ue={class:"tw-text-primary tw-font-bold"},Me=y("span",{class:"tw-ml-1 tw-text-primary tw-text-xs"},"元/月",-1),Re={class:"tw-ml-auto"},Ye=d({props:{item:null,loading:{type:Boolean,default:!1}},setup(e){const l=e,n=M();p((()=>n.itemAddingErrorMessage),(e=>{e&&F(e)}));const d=()=>{var e;n.addItem((e=((e,t)=>{for(var a in t||(t={}))i.call(t,a)&&r(e,a,t[a]);if(s)for(var a of s(t))o.call(t,a)&&r(e,a,t[a]);return e})({},l.item),t(e,a({quantity:1}))))},u={name:"mobile-products-id",params:{id:l.item.id}};return(t,a)=>{const s=_e,i=z,o=D,r=J,l=j("router-link");return e.loading?(x(),T(s,{key:0})):(x(),T(l,{key:1,to:u},{default:k((()=>[y("figure",He,[f(i,{class:"tw-w-full tw-h-32",src:e.item.thumbnail,fit:"cover",round:"",radius:"8px"},null,8,["src"]),y("div",Le,[y("figcaption",Ae,V(e.item.title),1),y("span",Ee,V(e.item.body),1)]),y("div",ze,[y("span",Ue,V(e.item.price),1),Me,y("span",Re,[f(r,{round:"",size:"small",type:"primary",disabled:O(n).isItemAdding,onClick:I(d,["prevent","stop"])},{default:k((()=>[f(o,{size:"16"})])),_:1},8,["disabled","onClick"])])])])])),_:1}))}}}),Fe={key:0,class:"tw-pb-56"},qe=d({setup(e){const t=[...Array(10).keys()].map((e=>({id:String(e)}))),a=W(),{items:s,isItemsLoading:i,isItemsEmpty:o,isLastPage:r,itemsLoadingErrorMessage:l}=S(a),n=u(!1),d=m((()=>!!l.value)),c=m((()=>o.value&&i.value||n.value)),p=m((()=>o.value&&!i.value)),v=m((()=>c.value?t:s.value)),h=()=>{a.nextPage()},w=async()=>{n.value=!0,await a.getItemsAndReset(),await _(200),n.value=!1};return a.getItems(),(e,t)=>{const a=N,s=Ye,o=ke,u=Se;return x(),b("div",null,[f(u,{modelValue:n.value,"onUpdate:modelValue":t[1]||(t[1]=e=>n.value=e),onRefresh:w},{default:k((()=>[O(p)?(x(),b("div",Fe,[f(a,{description:"商品列表为空"})])):(x(),T(o,{key:1,loading:O(i),"onUpdate:loading":t[0]||(t[0]=e=>P(i)?i.value=e:null),finished:O(r),"finished-text":"没有更多了","immediate-check":!1,error:O(d),"error-text":O(l),onLoad:h},{default:k((()=>[(x(!0),b(B,null,C(O(v),(e=>(x(),T(s,{key:e.id,item:e,loading:O(c)},null,8,["item","loading"])))),128))])),_:1},8,["loading","finished","error","error-text"]))])),_:1},8,["modelValue"])])}}});const Ge={class:"tw-truncate"},Je=d({props:{modelValue:{default:"310000"},placeholder:{default:"省/市/区"}},emits:["update:modelValue"],setup(e,{emit:t}){const a=e,s=H(a,"modelValue"),i=u(!1),o=L(i),r=u([]),l=m((()=>!r.value.length)),n=m((()=>l.value?a.placeholder:r.value.map((e=>e.name)).filter((e=>!!e)).join("/"))),d=m((()=>l.value?"tw-text-medium":"tw-text-primary")),c=u(),p=()=>{var e,t;return null==(t=null==(e=c.value)?void 0:e.getArea)?void 0:t.call(e)};w((()=>{const e=p();e&&(r.value=[{name:e.province},{name:e.city},{name:e.county}])}));const v=()=>{o(!1)},h=e=>{r.value=(e=>e.filter((e=>!!e)))(e);const a=p();a&&t("update:modelValue",a.code),o(!1)};return(e,t)=>{const a=E,r=he,l=q;return x(),b("div",null,[y("a",{class:A([O(d),"tw-max-w-40 tw-inline-flex tw-items-center tw-px-3 tw-py-1.5 tw-shadow tw-shadow-primary tw-rounded tw-bg-white"]),onClick:t[0]||(t[0]=I((e=>O(o)()),["prevent"]))},[y("span",Ge,V(O(n)),1),f(a,{class:"tw-ml-2"})],2),f(l,{show:i.value,"onUpdate:show":t[1]||(t[1]=e=>i.value=e),position:"bottom","close-on-popstate":"","lazy-render":!1},{default:k((()=>[f(r,{ref_key:"areaPicker",ref:c,value:O(s),"area-list":O(ve),"columns-placeholder":["请选择","请选择","请选择"],onCancel:v,onConfirm:h},null,8,["value","area-list"])])),_:1},8,["show"])])}}});var Ne={};const We={ref:"wrapper",class:"tw-article"},Xe=d({setup(e){const t=Y(),a=e=>{t.updateUser({area:e})},s=u(!1),i=e=>{s.value=e};return(e,o)=>{const r=Je,l=fe,n=xe,d=qe;return x(),b("article",We,[f(n,{"offset-top":"46px",onChange:i},{default:k((()=>[y("div",{class:A(["tw-flex tw-items-center tw-justify-between tw-pr-2",s.value&&"tw-bg-white/75 tw--mx-6 tw-pl-6 tw-pr-8 tw-py-3 tw-shadow-md"])},[f(r,{"model-value":O(t).area,"onUpdate:modelValue":a},null,8,["model-value"]),f(l)],2)])),_:1}),f(d,{class:"tw-mt-4"})],512)}}});"function"==typeof Ne&&Ne(Xe);export{Xe as default};
