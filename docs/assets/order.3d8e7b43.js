var e=Object.defineProperty,r=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,n=(r,a,t)=>a in r?e(r,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[a]=t,o=(e,r)=>{for(var a in r||(r={}))l.call(r,a)&&n(e,a,r[a]);if(t)for(var a of t(r))i.call(r,a)&&n(e,a,r[a]);return e};import{d as s,f as u,aZ as c,aV as d,l as v,n as p,b4 as f,ag as g,aU as m,aa as b,a8 as y,g as h,F as w,L as x,af as j,ae as k,o as C,a as S,c as P,w as O}from"./vendor.cae3e354.js";import{_ as B}from"./CartList.23dc7d74.js";import{E as V}from"./index.27c4e81c.js";import{u as I}from"./product.244d727d.js";import{u as M}from"./cart.ece30a59.js";import{u as A,c as F,n as q,t as L,d as T,e as z,r as E,q as D,I as W,w as H,L as K,S as U,T as _,U as X,K as Z,j as G,V as J,a as N,W as Q,m as R,o as Y,l as $,p as ee,v as re,X as ae}from"./index.b05a476a.js";import{u as te}from"./function-call.9a037c21.js";import"./index.c867298c.js";import"./index.be5e4b0a.js";import"./index.a2230fa5.js";import"./interceptor.8fc59063.js";import"./product.e58922dc.js";import"./usePaginatedList.72bbe226.js";import"./index.4a907a91.js";import"./useAxios.7bef570f.js";var[le,ie]=F("cell"),ne={icon:String,size:String,title:q,value:q,label:q,center:Boolean,isLink:Boolean,border:L,required:Boolean,iconPrefix:String,valueClass:T,labelClass:T,titleClass:T,titleStyle:null,arrowDirection:String,clickable:{type:Boolean,default:null}},oe=H(s({name:le,props:z({},ne,E),setup(e,r){var{slots:a}=r,t=A(),l=()=>{if(a.label||D(e.label))return u("div",{class:[ie("label"),e.labelClass]},[a.label?a.label():e.label])},i=()=>{if(a.title||D(e.title))return u("div",{class:[ie("title"),e.titleClass],style:e.titleStyle},[a.title?a.title():u("span",null,[e.title]),l()])},n=()=>{var r=a.value||a.default;if(r||D(e.value)){var t=a.title||D(e.title);return u("div",{class:[ie("value",{alone:!t}),e.valueClass]},[r?r():u("span",null,[e.value])])}},o=()=>{if(a["right-icon"])return a["right-icon"]();if(e.isLink){var r=e.arrowDirection?"arrow-"+e.arrowDirection:"arrow";return u(W,{name:r,class:ie("right-icon")},null)}};return()=>{var r,{size:l,center:s,border:c,isLink:d,required:v}=e,p=null!=(r=e.clickable)?r:d,f={center:s,required:v,clickable:p,borderless:!c};return l&&(f[l]=!!l),u("div",{class:ie(f),role:p?"button":void 0,tabindex:p?0:void 0,onClick:t},[a.icon?a.icon():e.icon?u(W,{name:e.icon,class:ie("left-icon"),classPrefix:e.iconPrefix},null):void 0,i(),n(),o(),null==a.extra?void 0:a.extra()])}}}));function se(e,r){return(!r.required||!function(e){return Array.isArray(e)?!e.length:0!==e&&!e}(e))&&!(r.pattern&&!r.pattern.test(String(e)))}function ue(e,r){var{message:a}=r;return U(a)?a(e,r):a||""}function ce(e){var{target:r}=e;r.composing=!0}function de(e){var{target:r}=e;r.composing&&(r.composing=!1,r.dispatchEvent(new Event("input")))}function ve(e){return[...e].length}var pe=0;var[fe,ge]=F("field"),me=H(s({name:fe,props:z({},ne,{id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:q,formatter:Function,clearIcon:R("clear"),modelValue:$(""),inputAlign:String,placeholder:String,autocomplete:String,errorMessage:String,clearTrigger:R("focus"),formatTrigger:R("onChange"),error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null}},{rows:q,type:R("text"),rules:Array,autosize:[Boolean,Object],labelWidth:q,labelClass:T,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}}),emits:["blur","focus","clear","keypress","click-input","click-left-icon","click-right-icon","update:modelValue"],setup(e,r){var{emit:a,slots:t}=r,l=function(){var e=c(),{name:r="unknown"}=(null==e?void 0:e.type)||{};return r+"-"+ ++pe}(),i=d({focused:!1,validateFailed:!1,validateMessage:""}),n=v(),o=v(),{parent:s}=G(J),w=()=>{var r;return String(null!=(r=e.modelValue)?r:"")},x=r=>D(e[r])?e[r]:s&&D(s.props[r])?s.props[r]:void 0,j=p((()=>{var r=x("readonly");if(e.clearable&&!r){var a=""!==w(),t="always"===e.clearTrigger||"focus"===e.clearTrigger&&i.focused;return a&&t}return!1})),k=p((()=>o.value&&t.input?o.value():e.modelValue)),C=e=>e.reduce(((e,r)=>e.then((()=>{if(!i.validateFailed){var{value:e}=k;return r.formatter&&(e=r.formatter(e,r)),se(e,r)?r.validator?function(e,r){return new Promise((a=>{var t=r.validator(e,r);if(K(t))return t.then(a);a(t)}))}(e,r).then((a=>{a&&"string"==typeof a?(i.validateFailed=!0,i.validateMessage=a):!1===a&&(i.validateFailed=!0,i.validateMessage=ue(e,r))})):void 0:(i.validateFailed=!0,void(i.validateMessage=ue(e,r)))}}))),Promise.resolve()),S=()=>{i.validateFailed&&(i.validateFailed=!1,i.validateMessage="")},P=function(r){return void 0===r&&(r=e.rules),new Promise((a=>{S(),r?C(r).then((()=>{i.validateFailed?a({name:e.name,message:i.validateMessage}):a()})):a()}))},O=r=>{if(s&&e.rules){var a=s.props.validateTrigger===r,t=e.rules.filter((e=>e.trigger?e.trigger===r:a));t.length&&P(t)}},B=function(r,t){if(void 0===t&&(t="onChange"),r=(r=>{var{maxlength:a}=e;if(D(a)&&ve(r)>a){var t=w();return t&&ve(t)===+a?t:function(e,r){return[...e].slice(0,r).join("")}(r,+a)}return r})(r),"number"===e.type||"digit"===e.type){var l="number"===e.type;r=Y(r,l,l)}e.formatter&&t===e.formatTrigger&&(r=e.formatter(r)),n.value&&n.value.value!==r&&(n.value.value=r),r!==e.modelValue&&a("update:modelValue",r)},V=e=>{e.target.composing||B(e.target.value)},I=()=>{var e;return null==(e=n.value)?void 0:e.blur()},M=()=>{var r=n.value;"textarea"===e.type&&e.autosize&&r&&function(e,r){var a=_();e.style.height="auto";var t=e.scrollHeight;if(Z(r)){var{maxHeight:l,minHeight:i}=r;void 0!==l&&(t=Math.min(t,l)),void 0!==i&&(t=Math.max(t,i))}t&&(e.style.height=t+"px",X(a))}(r,e.autosize)},A=e=>{i.focused=!0,a("focus",e),m(M),x("readonly")&&I()},F=e=>{x("readonly")||(i.focused=!1,B(w(),"onBlur"),a("blur",e),O("onBlur"),m(M),re())},q=e=>a("click-input",e),L=e=>a("click-left-icon",e),T=e=>a("click-right-icon",e),z=e=>{ee(e),a("update:modelValue",""),a("clear",e)},E=p((()=>"boolean"==typeof e.error?e.error:!!(s&&s.props.showError&&i.validateFailed)||void 0)),H=p((()=>{var e=x("labelWidth");if(e)return{width:N(e)}})),U=r=>{13===r.keyCode&&(s&&s.props.submitOnEnter||"textarea"===e.type||ee(r),"search"===e.type&&I());a("keypress",r)},R=()=>e.id||l+"-input",$=()=>{var r=ge("control",[x("inputAlign"),{error:E.value,custom:!!t.input,"min-height":"textarea"===e.type&&!e.autosize}]);if(t.input)return u("div",{class:r,onClick:q},[t.input()]);var a,i={id:R(),ref:n,name:e.name,rows:void 0!==e.rows?+e.rows:void 0,class:r,value:e.modelValue,disabled:x("disabled"),readonly:x("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,"aria-labelledby":e.label?l+"-label":void 0,onBlur:F,onFocus:A,onInput:V,onClick:q,onChange:de,onKeypress:U,onCompositionend:de,onCompositionstart:ce};return"textarea"===e.type?u("textarea",i,null):u("input",y("number"===(a=e.type)?{type:"text",inputmode:"decimal"}:"digit"===a?{type:"tel",inputmode:"numeric"}:{type:a},i),null)},ae=()=>{var r=t["right-icon"];if(e.rightIcon||r)return u("div",{class:ge("right-icon"),onClick:T},[r?r():u(W,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},le=()=>{if(e.showWordLimit&&e.maxlength){var r=ve(w());return u("div",{class:ge("word-limit")},[u("span",{class:ge("word-num")},[r]),h("/"),e.maxlength])}},ie=()=>{if(!s||!1!==s.props.showErrorMessage){var r=e.errorMessage||i.validateMessage;if(r){var a=t["error-message"],l=x("errorMessageAlign");return u("div",{class:ge("error-message",l)},[a?a({message:r}):r])}}},ne=()=>[u("div",{class:ge("body")},[$(),j.value&&u(W,{name:e.clearIcon,class:ge("clear"),onTouchstart:z},null),ae(),t.button&&u("div",{class:ge("button")},[t.button()])]),le(),ie()];return te({blur:I,focus:()=>{var e;return null==(e=n.value)?void 0:e.focus()},validate:P,formValue:k,resetValidation:S}),f(Q,{customValue:o,resetValidation:S,validateWithTrigger:O}),g((()=>e.modelValue),(()=>{B(w()),S(),O("onChange"),m(M)})),b((()=>{B(w(),e.formatTrigger),m(M)})),()=>{var r,a=x("disabled"),i=x("labelAlign"),n=(r=x("colon")?":":"",t.label?[t.label(),r]:e.label?u("label",{id:l+"-label",for:R()},[e.label+r]):void 0),o=(()=>{var r=t["left-icon"];if(e.leftIcon||r)return u("div",{class:ge("left-icon"),onClick:L},[r?r():u(W,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])})();return u(oe,{size:e.size,icon:e.leftIcon,class:ge({error:E.value,disabled:a,["label-"+i]:i}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:H.value,valueClass:ge("value"),titleClass:[ge("label",[i,{required:e.required}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:o?()=>o:null,title:n?()=>n:null,value:ne,extra:t.extra})}}})),[be,ye]=F("cell-group"),he=H(s({name:be,inheritAttrs:!1,props:{title:String,inset:Boolean,border:L},setup(e,r){var{slots:a,attrs:t}=r,l=()=>u("div",y({class:[ye({inset:e.inset}),{[ae]:e.border&&!e.inset}]},t),[null==a.default?void 0:a.default()]);return()=>e.title||a.title?u(w,null,[u("div",{class:ye("title",{inset:e.inset})},[a.title?a.title():e.title]),l()]):l()}})),we=Object.defineProperty,xe=Object.defineProperties,je=Object.getOwnPropertyDescriptors,ke=Object.getOwnPropertySymbols,Ce=Object.prototype.hasOwnProperty,Se=Object.prototype.propertyIsEnumerable,Pe=(e,r,a)=>r in e?we(e,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[r]=a,Oe=(e,r)=>{for(var a in r||(r={}))Ce.call(r,a)&&Pe(e,a,r[a]);if(ke)for(var a of ke(r))Se.call(r,a)&&Pe(e,a,r[a]);return e};var Be={};const Ve={class:"tw-article !tw-pb-[56px]"},Ie=s({setup(e){const t=function(e,r,{mode:a="replace",route:t=j(),router:l=k()}={}){return p({get(){const a=t.query[e];return null==a?null!=r?r:null:Array.isArray(a)?a.filter(Boolean):a},set(r){m((()=>{var i,n;l[x(a)]({query:(i=Oe({},t.query),n={[e]:r},xe(i,je(n)))})}))}})}("id"),l=I(),i=M(),n=p((()=>{if(!t.value)return i.checkedItems;{const i=l.items.find((e=>e.id===t.value));if(i)return[(e=o({},i),n={quantity:1},r(e,a(n)))]}var e,n;return[]})),s=p((()=>!n.value.length));return(e,r)=>{const a=V,t=B,l=me,i=he;return C(),S("article",Ve,[x(s)?(C(),P(a,{key:0,image:"error",description:"出错了"})):(C(),P(t,{key:1,items:x(n),readonly:""},null,8,["items"])),u(i,{class:"tw-mt-6",inset:""},{default:O((()=>[u(l,{label:"备注"})])),_:1})])}}});"function"==typeof Be&&Be(Ie);export{Ie as default};
