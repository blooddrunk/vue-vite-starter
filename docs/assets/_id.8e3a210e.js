var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,n=(t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s;import{d as r,f as i,a8 as c,aX as d,n as u,l as m,o as p,a as f,L as v,c as b,F as g,w,e as j,a7 as y,t as x,g as _}from"./vendor.e60456f3.js";import{_ as h}from"./PageFooter.c2f40ea0.js";import{C as O}from"./index.a8ff1419.js";import{C as k}from"./index.0eef1764.js";import{_ as P}from"./CartList.a332858b.js";import{E as C}from"./index.ad89b4c6.js";import{u as I,c as T}from"./order.b151e58e.js";import{g as A}from"./index.9bc79dd0.js";import{G as L,c as S,e as B,t as N,x as E,m as D,I as F,H as R,w as U}from"./index.84f5d824.js";import{P as q,p as z,a as G,T as H}from"./function-call.7be5e6a9.js";import{L as M,B as X}from"./index.e74be4f5.js";import{D as J}from"./CartItem.6d9b22ca.js";import"./index.a9a156c1.js";import"./index.aa52fcaa.js";import"./useAxios.d5dc9735.js";import"./math.c4a34419.js";import"./on-popup-reopen.d93741ed.js";import"./interceptor.f210eca8.js";import"./index.aa76e96d.js";import"./index.7e4216b6.js";var[K,Q]=S("action-sheet"),V=B({},z,{title:String,round:N,actions:E(),closeIcon:D("cross"),closeable:N,cancelText:String,description:String,closeOnPopstate:N,closeOnClickAction:Boolean,safeAreaInsetBottom:N}),W=[...G,"round","closeOnPopstate","safeAreaInsetBottom"],Y=U(r({name:K,props:V,emits:["select","cancel","update:show"],setup(e,t){var{slots:a,emit:s}=t,l=e=>s("update:show",e),o=()=>{l(!1),s("cancel")},n=()=>{if(e.title)return i("div",{class:Q("header")},[e.title,e.closeable&&i(F,{name:e.closeIcon,class:[Q("close"),R],onClick:o},null)])},r=()=>{if(a.cancel||e.cancelText)return[i("div",{class:Q("gap")},null),i("button",{type:"button",class:Q("cancel"),onClick:o},[a.cancel?a.cancel():e.cancelText])]},u=(t,a)=>{var{name:o,color:n,subname:r,loading:c,callback:u,disabled:m,className:p}=t,f=c?i(M,{class:Q("loading-icon")},null):[i("span",{class:Q("name")},[o]),r&&i("div",{class:Q("subname")},[r])];return i("button",{type:"button",style:{color:n},class:[Q("item",{loading:c,disabled:m}),p],onClick:()=>{m||c||(u&&u(t),e.closeOnClickAction&&l(!1),d((()=>s("select",t,a))))}},[f])},m=()=>{if(e.description||a.description){var t=a.description?a.description():e.description;return i("div",{class:Q("description")},[t])}};return()=>i(q,c({class:Q(),position:"bottom","onUpdate:show":l},L(e,W)),{default:()=>[n(),m(),i("div",{class:Q("content")},[e.actions.map(u),null==a.default?void 0:a.default()]),r()]})}})),Z={};const $={class:"tw-article tw-article_has-footer"},ee=_(" ￥ "),te={class:"tw-font-semibold"},ae=j("span",null,[_(" ￥ "),j("strong",{class:"tw-font-semibold"}," -- ")],-1),se=_(" ￥ "),le={class:"tw-font-bold"},oe={class:"tw-mt-3"},ne=j("header",null,[j("h3",{class:"tw-p-2 tw-text-sm tw-font-bold"},"订单信息")],-1),re=_(" 撤单 "),ie=r({props:{id:null},setup(e){const r=e,c=I();c.isItemsEmpty&&c.getItems();const d=u((()=>c.items.find((e=>e.orderNumber===r.id)))),L=u((()=>!d.value&&!c.isItemsLoading)),{isPending:S,request:B}=T((()=>{H("撤单成功")}),(e=>{H(e.message)})),N=m(-1),E=u((()=>[{name:"信息填写错误"},{name:"不想要了"},{name:"商品错选/多选"}].map(((e,r)=>{return r===N.value?(i=((e,t)=>{for(var a in t||(t={}))l.call(t,a)&&n(e,a,t[a]);if(s)for(var a of s(t))o.call(t,a)&&n(e,a,t[a]);return e})({},e),c={loading:S.value},t(i,a(c))):e;var i,c})))),D=m(!1),F=async(e,t)=>{try{await J.confirm({title:"提示",message:"是否确认撤单？"}),N.value=t,console.log(e),B(d.value)}catch(a){}};return(e,t)=>{var a,s;const l=C,o=P,n=k,r=O,u=X,m=h,I=Y;return p(),f("article",$,[v(L)?(p(),b(l,{key:0,image:"error",description:"出错了"})):(p(),f(g,{key:1},[i(o,{items:null!=(s=null==(a=v(d))?void 0:a.items)?s:[],loading:v(c).isItemsLoading,readonly:""},null,8,["items","loading"]),i(r,{class:"!tw-mt-6 !tw-mx-0",inset:""},{default:w((()=>[i(n,{title:"商品金额"},{default:w((()=>{var e;return[j("span",null,[ee,j("strong",te,x(v(A)(null==(e=v(d))?void 0:e.totalPrice).value),1)])]})),_:1}),i(n,{title:"配送+安装费"},{default:w((()=>[ae])),_:1}),i(n,{title:"实付"},{default:w((()=>{var e;return[j("span",null,[se,j("strong",le,x(v(A)(null==(e=v(d))?void 0:e.totalPrice).value),1)])]})),_:1})])),_:1}),j("div",oe,[ne,i(r,{class:"!tw-mx-0",inset:""},{default:w((()=>[i(n,{title:"服务地址"},{default:w((()=>{var e;return[_(x(v(A)(null==(e=v(d))?void 0:e.address).value),1)]})),_:1}),i(n,{title:"订单编号"},{default:w((()=>{var e;return[_(x(v(A)(null==(e=v(d))?void 0:e.orderNumber).value),1)]})),_:1}),i(n,{title:"CRM订单号"},{default:w((()=>{var e;return[_(x(v(A)(null==(e=v(d))?void 0:e.crmNumber).value),1)]})),_:1}),i(n,{title:"下单时间"},{default:w((()=>{var e;return[_(x(v(A)(null==(e=v(d))?void 0:e.orderTime).value),1)]})),_:1}),i(n,{title:"上门时间"},{default:w((()=>{var e;return[_(x(v(A)(null==(e=v(d))?void 0:e.serviceTime).value),1)]})),_:1}),i(n,{title:"撤单原因"},{default:w((()=>{var e;return[_(x(v(A)(null==(e=v(d))?void 0:e.cancelReason).value),1)]})),_:1}),i(n,{title:"订单备注"},{default:w((()=>{var e;return[_(x(v(A)(null==(e=v(d))?void 0:e.remarks).value),1)]})),_:1})])),_:1})])],64)),i(m,{class:"tw-justify-end"},{default:w((()=>[i(u,{class:"tw-w-20",type:"danger",plain:"",round:"",size:"small",loading:v(S),onClick:t[0]||(t[0]=e=>D.value=!0)},{default:w((()=>[re])),_:1},8,["loading"])])),_:1}),v(d)?(p(),b(I,{key:2,show:D.value,"onUpdate:show":t[1]||(t[1]=e=>D.value=e),description:"申请撤单",actions:v(E),"close-on-click-action":"",onSelect:F},null,8,["show","actions"])):y("",!0)])}}});"function"==typeof Z&&Z(ie);export{ie as default};
