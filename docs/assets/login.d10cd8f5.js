var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,n=(a,l,o)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[l]=o;import{a2 as i,aT as r,d as u,ag as c,aa as d,b0 as p,f as m,a8 as v,l as b,b1 as f,n as h,p as g,aX as y,b9 as w,o as k,a as x,e as C,L as _,a4 as S,aZ as O,aq as V,a7 as j,t as P,g as B,k as $,m as z,ac as A,ba as L,ae as E,r as T,w as G}from"./vendor.a4ef30fa.js";import{B as D}from"./index.418b80cd.js";import{u as F}from"./useFormField.7634f690.js";import{_ as I}from"./index.16358824.js";import"./index.ab5ea04f.js";import{a as M,P as U}from"./index.5ac9ceb0.js";import{g as q,o as N,e as X,l as H,n as J,b as K,u as Z,I as Q,i as R,J as W,w as Y,a as ee,m as ae,t as le,F as oe,h as te,K as se,c as ne,d as ie}from"./index.30fefea8.js";import{L as re}from"./index.68852432.js";import"./use-route.1f47bd5d.js";import"./interceptor.86502246.js";var ue=0;var[ce,de]=X("toast"),pe=["show","overlay","transition","overlayClass","overlayStyle","closeOnClickOverlay"],me=u({name:ce,props:{icon:String,show:Boolean,type:H("text"),overlay:Boolean,message:J,iconSize:J,duration:K(2e3),position:H("middle"),className:Z,iconPrefix:String,transition:H("van-fade"),loadingType:String,forbidClick:Boolean,overlayClass:Z,overlayStyle:Object,closeOnClick:Boolean,closeOnClickOverlay:Boolean},emits:["update:show"],setup(e,a){var l,{emit:o}=a,t=!1,s=()=>{var a=e.show&&e.forbidClick;t!==a&&((t=a)?(ue||document.body.classList.add("van-toast--unclickable"),ue++):ue&&(--ue||document.body.classList.remove("van-toast--unclickable")))},n=e=>o("update:show",e),i=()=>{e.closeOnClick&&n(!1)},r=()=>clearTimeout(l),u=()=>{var{icon:a,type:l,iconSize:o,iconPrefix:t,loadingType:s}=e;return a||"success"===l||"fail"===l?m(Q,{name:a||l,size:o,class:de("icon"),classPrefix:t},null):"loading"===l?m(re,{class:de("loading"),size:o,type:s},null):void 0},b=()=>{var{type:a,message:l}=e;if(R(l)&&""!==l)return"html"===a?m("div",{class:de("text"),innerHTML:String(l)},null):m("div",{class:de("text")},[l])};return c((()=>[e.show,e.forbidClick]),s),c((()=>[e.show,e.type,e.message,e.duration]),(()=>{r(),e.show&&e.duration>0&&(l=setTimeout((()=>{n(!1)}),e.duration))})),d(s),p(s),()=>m(U,v({class:[de([e.position,{[e.type]:!e.icon}]),e.className],lockScroll:!1,onClick:i,onClosed:r,"onUpdate:show":n},N(e,pe)),{default:()=>[u(),b()]})}}),ve={icon:"",type:"text",message:"",className:"",overlay:!1,onClose:void 0,onOpened:void 0,duration:2e3,teleport:"body",iconSize:void 0,iconPrefix:void 0,position:"middle",transition:"van-fade",forbidClick:!1,loadingType:void 0,overlayClass:"",overlayStyle:void 0,closeOnClick:!1,closeOnClickOverlay:!1},be=[],fe=!1,he=q({},ve),ge=new Map;function ye(e){return ee(e)?e:{message:e}}function we(){var e,a,{instance:l,unmount:o}=(e=i({setup(){var e=b(""),{open:a,state:t,close:s,toggle:n}=function(){var e=r({show:!1}),a=a=>{e.show=a},l=l=>{q(e,l,{transitionAppear:!0}),a(!0)},o=()=>a(!1);return M({open:l,close:o,toggle:a}),{open:l,close:o,state:e,toggle:a}}(),i=()=>{fe&&(be=be.filter((e=>e!==l)),o())};return c(e,(e=>{t.message=e})),f().render=()=>m(me,v(t,{onClosed:i,"onUpdate:show":n}),null),{open:a,clear:s,message:e}}}),a=document.createElement("div"),document.body.appendChild(a),{instance:e.mount(a),unmount(){e.unmount(),document.body.removeChild(a)}});return l}function ke(e){if(void 0===e&&(e={}),!W)return{};var a=function(){if(!be.length||fe){var e=we();be.push(e)}return be[be.length-1]}(),l=ye(e);return a.open(q({},he,ge.get(l.type||he.type),l)),a}var xe=e=>a=>ke(q({type:e},ye(a)));ke.loading=xe("loading"),ke.success=xe("success"),ke.fail=xe("fail"),ke.clear=e=>{if(be.length)if(e)be.forEach((e=>{e.clear()})),be=[];else if(fe){var a;null==(a=be.shift())||a.clear()}else be[0].clear()},ke.setDefaultOptions=function(e,a){"string"==typeof e?ge.set(e,a):q(he,e)},ke.resetDefaultOptions=e=>{"string"==typeof e?ge.delete(e):(he=q({},ve),ge.clear())},ke.allowMultiple=function(e){void 0===e&&(e=!0),fe=e},ke.install=e=>{e.use(Y(me)),e.config.globalProperties.$toast=ke};var Ce={name:Z,shape:H("round"),disabled:Boolean,iconSize:J,modelValue:Z,checkedColor:String,labelPosition:String,labelDisabled:Boolean},_e=u({props:q({},Ce,{bem:ae(Function),role:String,parent:Object,checked:Boolean,bindGroup:le}),emits:["click","toggle"],setup(e,a){var{emit:l,slots:o}=a,t=b(),s=a=>{if(e.parent&&e.bindGroup)return e.parent.props[a]},n=h((()=>s("disabled")||e.disabled)),i=h((()=>s("direction"))),r=h((()=>{var a=e.checkedColor||s("checkedColor");if(a&&e.checked&&!n.value)return{borderColor:a,backgroundColor:a}})),u=a=>{var{target:o}=a,s=t.value,i=s===o||(null==s?void 0:s.contains(o));n.value||!i&&e.labelDisabled||l("toggle"),l("click",a)},c=()=>{var{bem:a,shape:l,checked:i}=e,u=e.iconSize||s("iconSize");return m("div",{ref:t,class:a("icon",[l,{disabled:n.value,checked:i}]),style:{fontSize:oe(u)}},[o.icon?o.icon({checked:i,disabled:n.value}):m(Q,{name:"success",style:r.value},null)])},d=()=>{if(o.default)return m("span",{class:e.bem("label",[e.labelPosition,{disabled:n.value}])},[o.default()])};return()=>{var a="left"===e.labelPosition?[d(),c()]:[c(),d()];return m("div",{role:e.role,class:e.bem([{disabled:n.value,"label-disabled":e.labelDisabled},i.value]),tabindex:n.value?void 0:0,"aria-checked":e.checked,onClick:u},[a])}}}),[Se,Oe]=X("checkbox-group"),Ve={max:J,disabled:Boolean,iconSize:J,direction:String,modelValue:ne(),checkedColor:String},je=Symbol(Se);u({name:Se,props:Ve,emits:["change","update:modelValue"],setup(e,a){var{emit:l,slots:o}=a,{children:t,linkChildren:s}=te(je),n=e=>l("update:modelValue",e);return c((()=>e.modelValue),(e=>l("change",e))),M({toggleAll:function(e){void 0===e&&(e={}),"boolean"==typeof e&&(e={checked:e});var{checked:a,skipDisabled:l}=e,o=t.filter((e=>!!e.props.bindGroup&&(e.props.disabled&&l?e.checked.value:null!=a?a:!e.checked.value))).map((e=>e.name));n(o)}}),se((()=>e.modelValue)),s({props:e,updateValue:n}),()=>m("div",{class:Oe([e.direction])},[null==o.default?void 0:o.default()])}});var[Pe,Be]=X("checkbox"),$e=u({name:Pe,props:q({},Ce,{bindGroup:le}),emits:["change","update:modelValue"],setup(e,a){var{emit:l,slots:o}=a,{parent:t}=ie(je),s=h((()=>t&&e.bindGroup?-1!==t.props.modelValue.indexOf(e.name):!!e.modelValue)),n=function(a){void 0===a&&(a=!s.value),t&&e.bindGroup?(a=>{var{name:l}=e,{max:o,modelValue:s}=t.props,n=s.slice();if(a)o&&n.length>=o||n.includes(l)||(n.push(l),e.bindGroup&&t.updateValue(n));else{var i=n.indexOf(l);-1!==i&&(n.splice(i,1),e.bindGroup&&t.updateValue(n))}})(a):l("update:modelValue",a)};return c((()=>e.modelValue),(e=>l("change",e))),M({toggle:n,props:e,checked:s}),se((()=>e.modelValue)),()=>m(_e,v({bem:Be,role:"checkbox",parent:t,checked:s.value,onToggle:n},e),N(o,["default","icon"]))}}),ze=Y($e);var Ae={input:"_input_77e7o_2",control:"_control_77e7o_5",controlActive:"_controlActive_77e7o_29",labelActive:"_labelActive_77e7o_42"};const Le=["for"],Ee=["id","value","placeholder"],Te={key:1,class:"tw-ml-auto tw-pl-1 tw-flex-shrink-0"},Ge={key:0,class:"tw-absolute tw-top-full tw-left-0"},De={class:"tw-px-2 tw-text-xs tw-text-red-500 tw-font-medium tw-leading-none"},Fe=u({inheritAttrs:!1}),Ie=u((Me=((e,a)=>{for(var l in a||(a={}))t.call(a,l)&&n(e,l,a[l]);if(o)for(var l of o(a))s.call(a,l)&&n(e,l,a[l]);return e})({},Fe),Ue={props:{name:null,label:{default:""},showLabel:{type:Boolean,default:!1},placeholder:{default:""},showValidationError:{type:Boolean,default:!0},wrapperClass:{default:void 0}},emits:["focus","blur","input","change"],setup(e,{emit:a}){const l=e,o=b(null),t=w(),s=h((()=>!(!t.label&&!l.label))),{listeners:n,errorMessage:i,value:r,meta:u}=F({name:l.name,label:l.label}),c=b(!1),d=()=>{c.value=!0,a("focus")},p=e=>{n.value.onBlur(e),c.value=!1,a("blur")},m=e=>{n.value["onUpdate:modelValue"](e),a("input",e.target.value)},f=e=>{n.value.onChange(e),a("change",e.target.value)},g=h((()=>c.value||u.dirty&&r.value||l.placeholder));return(a,l)=>(k(),x("div",{class:S([a.$style.input,e.wrapperClass,e.showValidationError&&"tw-relative tw-mb-4"])},[C("div",{class:S({[a.$style.control]:!0,[a.$style.controlActive]:c.value})},[e.showLabel&&_(s)?(k(),x("label",{key:0,class:S({[a.$style.labelActive]:_(g)}),for:e.name,onClick:l[0]||(l[0]=e=>o.value.focus()),onTouchstart:l[1]||(l[1]=O((e=>o.value.focus()),["stop"]))},[V(a.$slots,"label",{},(()=>[C("span",null,P(e.label),1)]))],42,Le)):j("",!0),C("input",v({id:e.name,ref_key:"input",ref:o,value:_(r),placeholder:e.placeholder},a.$attrs,{onFocus:d,onBlur:p,onInput:m,onChange:f}),null,16,Ee),a.$slots.append?(k(),x("div",Te,[V(a.$slots,"append")])):j("",!0)],2),e.showValidationError&&_(i)?(k(),x("p",Ge,[C("span",De,[V(a.$slots,"error",{error:_(i)},(()=>[B(P(_(i)),1)]))])])):j("",!0)],2))}},a(Me,l(Ue))));var Me,Ue;const qe={};qe.$style=Ae;var Ne=I(Ie,[["__cssModules",qe]]);const Xe=$("mobile-auth",(()=>{const e=b({user:z("hsop_auth_mobile_user",{mobile:"13312331233"})}),a=h((()=>e.value.user)),l=h((()=>a.value.mobile)),o=h((()=>!!l.value)),t=b(!1),s=b(""),n=h((()=>!!s.value));return{user:a,mobile:l,isLoggedIn:o,loginError:s,hasLoginError:n,isLoginPending:t,login:async a=>{t.value=!0,s.value="";try{if(console.log(a),await g(1e3),"123456"!==a.authCode)throw new Error("wrong auth info");e.value.user={mobile:a.mobile}}catch(l){console.error(l),s.value=l.message}finally{t.value=!1}},logout:()=>{e.value.user={},s.value=""}}}));var He={};const Je={class:"tw-flex tw-flex-col tw-h-screen tw-pt-[15vh] tw-pb-8 tw-px-8"},Ke=C("header",null,[C("h3",{class:"tw-py-3 tw-text-2xl tw-font-bold"},"手机快捷登录"),C("p",{class:"tw-text-sm tw-text-medium"},"未注册过的手机号将自动创建账号")],-1),Ze=["onClick"],Qe={class:"tw-mt-16 tw-text-center"},Re={class:"tw-mt-auto tw-flex tw-justify-center tw-text-xs"},We={class:""},Ye=B(" 登录即代表同意 "),ea=B(" 《用户协议》 "),aa=B(" 和 "),la=B(" 《隐私政策》 "),oa=u({setup(e){const{values:a,validateField:l,isSubmitting:o,handleSubmit:t}=A({validationSchema:{mobile:"required|mobile",authCode:"required|numeric|max:6"},initialValues:{mobile:"",authCode:""}}),s=b(10),{isActive:n,pause:i,resume:r}=L((()=>{s.value--,s.value<=0&&i()}),1e3,{immediate:!1,immediateCallback:!0}),u=h((()=>n.value?`${s.value}s后重新获取`:"获取验证码")),d=async()=>{const{valid:e}=await l("mobile");e&&(n.value||(s.value=10,await(async e=>(console.log(e),await g(1e3),y(1e3)))(a.mobile),r()))},p=b(!1),v=b(""),f=()=>{v.value=""},w=Xe();c((()=>w.loginError),(e=>{e&&ke.fail(e)}));const V=E(),j=t((async e=>{if(!p.value)return ke("请先阅读并同意用户协议和隐私政策"),void(v.value="animate__animated animate__shakeX");v.value="",await w.login(e),w.isLoggedIn&&V.replace({name:"mobile"})}));return(e,a)=>{const l=Ne,t=D,s=T("router-link"),i=ze;return k(),x("article",Je,[Ke,C("form",{class:"tw-mt-12",onSubmit:a[0]||(a[0]=O((()=>{}),["prevent"]))},[m(l,{name:"mobile",label:"手机号",type:"text",inputmode:"numeric",maxlength:"11",pattern:"^1\\d{10}",placeholder:"请输入手机号"}),m(l,{name:"authCode",label:"验证码",type:"text",inputmode:"numeric",autocomplete:"one-time-code",maxlength:"6",pattern:"\\d{6}",placeholder:"请输入验证码"},{append:G((()=>[C("a",{class:S(_(n)?"tw-text-slate-400/75":"tw-text-primary"),onClick:O(d,["prevent"])},P(_(u)),11,Ze)])),_:1}),C("div",Qe,[m(t,{class:"tw-w-11/12",type:"primary",round:"",loading:_(o),onClick:_(j)},{default:G((()=>[B(P(_(o)?"登录中...":"登录"),1)])),_:1},8,["loading","onClick"])])],32),C("footer",Re,[m(i,{modelValue:p.value,"onUpdate:modelValue":a[1]||(a[1]=e=>p.value=e),class:S(v.value),"icon-size":"16px",onAnimationend:f},{default:G((()=>[C("span",We,[Ye,m(s,{class:"tw-text-primary",to:"/mobile/user-agreement"},{default:G((()=>[ea])),_:1}),aa,m(s,{class:"tw-text-primary",to:"/mobile/privacy-policy"},{default:G((()=>[la])),_:1})])])),_:1},8,["modelValue","class"])])])}}});"function"==typeof He&&He(oa);export{oa as default};
