var e=Object.defineProperty,a=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,l=(a,t,r)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,s=(e,s)=>{for(var i in s||(s={}))t.call(s,i)&&l(e,i,s[i]);if(a)for(var i of a(s))r.call(s,i)&&l(e,i,s[i]);return e};import{i,t as u}from"./index.9bc79dd0.js";import{u as o}from"./useAxios.d5dc9735.js";import{l as n,n as v,ag as g,aS as p,ax as m,aT as c,L as f,M as P}from"./vendor.e60456f3.js";const d=e=>{if(void 0!==e&&!i(e))throw new Error(`[usePagination]: (${e}) must be of number type`)},b=e=>({items:(null==e?void 0:e.items)||[],total:(null==e?void 0:e.total)||0}),y=(e,a={})=>{const{filter:t={},initialItems:r=[],transformPaginationToQuery:l=(e=>({page:e.currentPage.value,pageSize:e.pageSize.value})),infinite:i=!1}=a,y=n(t),h=n({}),S=(({pageSize:e=20,total:a=0,currentPage:t=1}={})=>{const r=n(t),l=n(e),s=n(a),i=v({get:()=>s.value,set:e=>{d(e),s.value=e}}),u=v({get:()=>l.value,set:e=>{d(e),l.value=e}}),o=v((()=>i.value?Math.ceil(i.value/u.value):1)),p=v({get:()=>r.value,set:e=>{d(e),r.value=((e,a,t)=>e<a?a:e>t?t:e)(e,1,o.value)}}),m=v((()=>Math.min((p.value-1)*u.value,i.value))),c=v((()=>1===p.value)),f=v((()=>p.value===o.value));return g([i,u],(()=>{p.value>o.value&&(p.value=o.value)})),{pageSize:u,total:i,currentPage:p,lastPagePage:o,offset:m,isFirstPage:c,isLastPage:f,nextPage:()=>{++p.value},prevPage:()=>{--p.value},firstPage:()=>{p.value=1},lastPage:()=>{p.value=o.value},jumpToPage:e=>{p.value=e}}})(a),j=s({__transformData:b},e),w=e=>{var a;const t=s(s({},u(f(h))),l(S)),r=P({},j,e),i="get"===(null!=(a=null==r?void 0:r.method)?a:"get").toLowerCase()?{params:t}:{data:t};return s(s({},r),i)},{data:z,isPending:O,errorMessage:x,request:L}=o({items:r,total:S.total.value},w(),{immediate:!1,resetOnRequest:!1}),A=m([]);g(z,(e=>{if(!e||!e.items||!Array.isArray(e.items))throw new Error("[fetchList] expects response data to be an object with 'items' and 'total'(optional) as keys, do you forget to define a proper data transformer?");i&&!S.isFirstPage.value?A.value=A.value.concat(e.items):A.value=e.items,S.total.value=e.total||0}));const M=()=>(h.value=c(f(y)),L(w()));g(S.currentPage,(()=>{M()})),g(S.pageSize,(()=>{M()}));const T=v((()=>({items:A.value,loading:O.value,total:S.total.value,page:S.currentPage.value,updatePage:S.jumpToPage,pageSize:S.pageSize.value,updatePageSize:e=>{S.pageSize.value=e}})));return{items:A,isPending:O,errorMessage:x,isEmpty:v((()=>!A.value.length)),pagination:S,fetchList:M,fetchListAndReset:()=>{if(S.isFirstPage.value)return M();S.currentPage.value=1},filter:y,lastAppliedFilter:p(h),elementTableProps:T}};export{y as u};
